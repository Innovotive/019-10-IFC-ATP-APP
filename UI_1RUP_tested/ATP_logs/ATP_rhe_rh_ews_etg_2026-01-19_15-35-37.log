[15:35:37] [INIT] ID pins configured (ACTIVE-HIGH, ID3 OFF)
[15:35:37] === ATP START — IDs: {1: 'rhe', 2: 'rh', 3: 'ews', 4: 'etg'} ===
[15:35:37] [FILE] Log created: ATP_logs/ATP_rhe_rh_ews_etg_2026-01-19_15-35-37.log
[15:35:37] [UI] Setup COMPLETE — Quick Test enabled
[15:35:38] [UI] Quick Test START
[15:35:38] [HW] relay_on()
[15:35:39] [GATE 1] REAL (RUP1)
[15:35:39] [GATE 2] REAL (RUP1)
[15:35:42] [UI] Quick Test COMPLETE
[15:35:51] [UI] Full ATP START
[15:35:52] [GATE 3] SIMULATED (depends on Gate 2)
[15:35:53] ============================================================
[15:35:53] [GATE4] Termination test (peak-based via can_commands)
[15:35:53] [GATE4] settle=2.5s window=3.0s fs=500Hz thresh=2.8V topN=20
[15:35:53] [GATE4] PASS needs OFF>ON: dvmax≥0.12V and dtopMean≥0.08V
[15:35:53] [GATE4] SPI + GPIO initialized
[15:35:53] [GATE4] → Sending TERMINATION_ON
[15:35:53] [GATE4] Waiting 2.5s before measuring ON...
[15:35:55] [GATE4] Measuring ON window...
[15:35:58] [GATE4] ON : vmax=2.527V, top20_mean=None, above=0 (0.0%)
[15:35:58] [GATE4] → Sending TERMINATION_OFF
[15:35:58] [GATE4] Waiting 2.5s before measuring OFF...
[15:36:01] [GATE4] Measuring OFF window...
[15:36:04] [GATE4] OFF: vmax=3.866V, top20_mean=3.8626588465298144, above=538 (35.9%)
[15:36:04] [GATE4][FAIL] Not enough 'high' samples to compute top-mean. Lower HIGH_THRESH_V (2.7–2.9) or ensure bus traffic exists.
[15:36:04] [GATE4] SPI + GPIO released
[15:36:04] ==================================================
[15:36:04] [GATE5] Starting IUL (Indicator Light) test
[15:36:04] [GATE5] Expectations:
[15:36:04]         IUL_ON  → GPIO LOW  (LED ON)
[15:36:04]         IUL_OFF → GPIO HIGH (LED OFF)
[15:36:04] [GATE5] GPIO18 configured as INPUT
[15:36:04] [GATE5] → Sending IUL_ON (0xE1)
[15:36:04] [GATE5] Waiting 4s for LED to settle
[15:36:08] [GATE5] GPIO read 1: 1
[15:36:12] [GATE5] GPIO read 2: 1
[15:36:16] [GATE5] GPIO read 3: 1
[15:36:20] [GATE5] GPIO read 4: 1
[15:36:23] [GATE5] Cleaning up GPIO
[15:36:23] ==================================================
