[15:23:47] [INIT] ID pins configured (ACTIVE-HIGH, ID3 OFF)
[15:23:47] === ATP START — IDs: {1: 'tyjs', 2: 'srjh', 3: 'tsj', 4: 'hts'} ===
[15:23:47] [FILE] Log created: ATP_logs/ATP_tyjs_srjh_tsj_hts_2026-01-19_15-23-47.log
[15:23:47] [UI] Setup COMPLETE — Quick Test enabled
[15:23:48] [UI] Quick Test START
[15:23:48] [HW] relay_on()
[15:23:49] [GATE 1] REAL (RUP1)
[15:23:50] [GATE 2] REAL (RUP1)
[15:23:53] [UI] Quick Test COMPLETE
[15:23:55] [UI] Full ATP START
[15:23:56] [GATE 3] SIMULATED (depends on Gate 2)
[15:23:57] ============================================================
[15:23:57] [GATE4] Termination test (peak-based via can_commands)
[15:23:57] [GATE4] settle=2.5s window=3.0s fs=500Hz thresh=2.8V topN=20
[15:23:57] [GATE4] PASS needs OFF>ON: dvmax≥0.12V and dtopMean≥0.08V
[15:23:57] [GATE4] SPI + GPIO initialized
[15:23:57] [GATE4] → Sending TERMINATION_ON
[15:23:57] [GATE4] Waiting 2.5s before measuring ON...
[15:24:00] [GATE4] Measuring ON window...
[15:24:03] [GATE4] ON : vmax=3.651V, top20_mean=3.64247311827957, above=510 (34.0%)
[15:24:03] [GATE4] → Sending TERMINATION_OFF
[15:24:03] [GATE4] Waiting 2.5s before measuring OFF...
[15:24:05] [GATE4] Measuring OFF window...
[15:24:08] [GATE4] OFF: vmax=3.866V, top20_mean=3.8597262952101663, above=539 (35.9%)
[15:24:08] [GATE4] Δ metrics: dvmax=0.215V, dtopMean=0.217V
[15:24:08] [GATE4] PASS — termination change detected
[15:24:08] [GATE4] SPI + GPIO released
[15:24:08] ==================================================
[15:24:08] [GATE5] Starting IUL (Indicator Light) test
[15:24:08] [GATE5] Expectations:
[15:24:08]         IUL_ON  → GPIO LOW  (LED ON)
[15:24:08]         IUL_OFF → GPIO HIGH (LED OFF)
[15:24:08] [GATE5] GPIO25 configured as INPUT
[15:24:08] [GATE5] → Sending IUL_ON (0xE1)
[15:24:08] [GATE5] Waiting 4s for LED to settle
[15:24:12] [GATE5] GPIO read 1: 1
[15:24:16] [GATE5] GPIO read 2: 1
[15:24:20] [GATE5] GPIO read 3: 1
[15:24:24] [GATE5] GPIO read 4: 1
[15:24:28] [GATE5][FAIL] IUL_ON but GPIO is not LOW
[15:24:28] [GATE5] Cleaning up GPIO
[15:24:29] ==================================================
[15:24:32] [GATE7] Starting Gate 7 power check
[15:24:32] [GATE7] PM125 connected
[15:24:32] [GATE7] PM125 clean start: set 5V and 0mA
[15:24:35] [GATE7] RUP: sending POWER_TO_60W (once at start)
[15:24:37] --------------------------------------------------
[15:24:37] [GATE7] STEP 60W | desired 20.0V | target 60W
[15:24:37] [GATE7] PM125: negotiating voltage...
[15:24:39]    try idx=4 -> CONSTAT voltage=20000 mV
[15:24:39] [GATE7] FINAL CONSTAT: {'port_status': 1, 'profile_index': 4, 'profile': 5, 'profile_subtype': 0, 'voltage_mv': 20000, 'max_current_ma': 2990, 'max_power_mw': 59800}
[15:24:39] [GATE7] Clamp: target 3000 mA > max 2990 mA
[15:24:39] [GATE7] PM125: ramp current to 2990 mA
[15:24:40]    ↳ set_current(250 mA) | STAT: {'status': 0, 'temperature_c': 25, 'voltage_mv': 20436, 'set_current_ma': 250, 'current_ma': 250, 'loopback_current_ma': 0}
[15:24:41]    ↳ set_current(500 mA) | STAT: {'status': 0, 'temperature_c': 25, 'voltage_mv': 20282, 'set_current_ma': 500, 'current_ma': 502, 'loopback_current_ma': 0}
[15:24:42]    ↳ set_current(750 mA) | STAT: {'status': 0, 'temperature_c': 25, 'voltage_mv': 20141, 'set_current_ma': 750, 'current_ma': 750, 'loopback_current_ma': 0}
[15:24:43]    ↳ set_current(1000 mA) | STAT: {'status': 0, 'temperature_c': 25, 'voltage_mv': 19994, 'set_current_ma': 1000, 'current_ma': 992, 'loopback_current_ma': 0}
[15:24:44]    ↳ set_current(1250 mA) | STAT: {'status': 0, 'temperature_c': 25, 'voltage_mv': 19859, 'set_current_ma': 1250, 'current_ma': 1248, 'loopback_current_ma': 0}
[15:24:45]    ↳ set_current(1500 mA) | STAT: {'status': 0, 'temperature_c': 25, 'voltage_mv': 19706, 'set_current_ma': 1500, 'current_ma': 1498, 'loopback_current_ma': 0}
[15:24:46]    ↳ set_current(1750 mA) | STAT: {'status': 0, 'temperature_c': 25, 'voltage_mv': 19571, 'set_current_ma': 1750, 'current_ma': 1750, 'loopback_current_ma': 0}
[15:24:47]    ↳ set_current(2000 mA) | STAT: {'status': 0, 'temperature_c': 25, 'voltage_mv': 19448, 'set_current_ma': 2000, 'current_ma': 2003, 'loopback_current_ma': 0}
[15:24:48]    ↳ set_current(2250 mA) | STAT: {'status': 0, 'temperature_c': 25, 'voltage_mv': 19282, 'set_current_ma': 2250, 'current_ma': 2252, 'loopback_current_ma': 0}
[15:24:49]    ↳ set_current(2500 mA) | STAT: {'status': 0, 'temperature_c': 25, 'voltage_mv': 19141, 'set_current_ma': 2500, 'current_ma': 2501, 'loopback_current_ma': 0}
[15:24:50]    ↳ set_current(2750 mA) | STAT: {'status': 0, 'temperature_c': 25, 'voltage_mv': 18988, 'set_current_ma': 2750, 'current_ma': 2752, 'loopback_current_ma': 0}
[15:24:51]    ↳ set_current(2990 mA) | STAT: {'status': 0, 'temperature_c': 25, 'voltage_mv': 18841, 'set_current_ma': 2990, 'current_ma': 2991, 'loopback_current_ma': 0}
[15:24:51] … PM125: 18.85 V, 2.988 A => 56.33 W (target 60 W)
[15:24:51] [GATE7] PM PASS — 56.33W in [42.00,78.00]
[15:24:51] [GATE7] RUP: POWER_REPORT_REQUEST (0xA2)
[15:24:54] [GATE7][FAIL] No / invalid POWER_REPORT from RUP
[15:24:54] [GATE7] Gate7 pass=False (RUP1 real, RUP2-4 simulated)
[15:24:54] [GATE7] Starting Gate 7 power check
[15:24:54] [GATE7] PM125 connected
[15:24:54] [GATE7] PM125 clean start: set 5V and 0mA
[15:24:54] [GATE7] RUP: sending POWER_TO_60W (once at start)
[15:24:54] --------------------------------------------------
[15:24:54] [GATE7] STEP 60W | desired 20.0V | target 60W
[15:24:54] [GATE7] PM125: negotiating voltage...
[15:24:54]    try idx=4 -> CONSTAT voltage=20000 mV
[15:24:54] [GATE7] FINAL CONSTAT: {'port_status': 1, 'profile_index': 4, 'profile': 5, 'profile_subtype': 0, 'voltage_mv': 20000, 'max_current_ma': 2990, 'max_power_mw': 59800}
[15:24:54] [GATE7] Clamp: target 3000 mA > max 2990 mA
[15:24:54] [GATE7] PM125: ramp current to 2990 mA
[15:24:54]    ↳ set_current(250 mA) | STAT: {'status': 0, 'temperature_c': 25, 'voltage_mv': 20436, 'set_current_ma': 250, 'current_ma': 250, 'loopback_current_ma': 0}
[15:24:54]    ↳ set_current(500 mA) | STAT: {'status': 0, 'temperature_c': 25, 'voltage_mv': 20282, 'set_current_ma': 500, 'current_ma': 502, 'loopback_current_ma': 0}
[15:24:54]    ↳ set_current(750 mA) | STAT: {'status': 0, 'temperature_c': 25, 'voltage_mv': 20141, 'set_current_ma': 750, 'current_ma': 750, 'loopback_current_ma': 0}
[15:24:54]    ↳ set_current(1000 mA) | STAT: {'status': 0, 'temperature_c': 25, 'voltage_mv': 19994, 'set_current_ma': 1000, 'current_ma': 992, 'loopback_current_ma': 0}
[15:24:54]    ↳ set_current(1250 mA) | STAT: {'status': 0, 'temperature_c': 25, 'voltage_mv': 19859, 'set_current_ma': 1250, 'current_ma': 1248, 'loopback_current_ma': 0}
[15:24:54]    ↳ set_current(1500 mA) | STAT: {'status': 0, 'temperature_c': 25, 'voltage_mv': 19706, 'set_current_ma': 1500, 'current_ma': 1498, 'loopback_current_ma': 0}
[15:24:54]    ↳ set_current(1750 mA) | STAT: {'status': 0, 'temperature_c': 25, 'voltage_mv': 19571, 'set_current_ma': 1750, 'current_ma': 1750, 'loopback_current_ma': 0}
[15:24:54]    ↳ set_current(2000 mA) | STAT: {'status': 0, 'temperature_c': 25, 'voltage_mv': 19448, 'set_current_ma': 2000, 'current_ma': 2003, 'loopback_current_ma': 0}
[15:24:54]    ↳ set_current(2250 mA) | STAT: {'status': 0, 'temperature_c': 25, 'voltage_mv': 19282, 'set_current_ma': 2250, 'current_ma': 2252, 'loopback_current_ma': 0}
[15:24:54]    ↳ set_current(2500 mA) | STAT: {'status': 0, 'temperature_c': 25, 'voltage_mv': 19141, 'set_current_ma': 2500, 'current_ma': 2501, 'loopback_current_ma': 0}
[15:24:54]    ↳ set_current(2750 mA) | STAT: {'status': 0, 'temperature_c': 25, 'voltage_mv': 18988, 'set_current_ma': 2750, 'current_ma': 2752, 'loopback_current_ma': 0}
[15:24:54]    ↳ set_current(2990 mA) | STAT: {'status': 0, 'temperature_c': 25, 'voltage_mv': 18841, 'set_current_ma': 2990, 'current_ma': 2991, 'loopback_current_ma': 0}
[15:24:54] … PM125: 18.85 V, 2.988 A => 56.33 W (target 60 W)
[15:24:54] [GATE7] PM PASS — 56.33W in [42.00,78.00]
[15:24:54] [GATE7] RUP: POWER_REPORT_REQUEST (0xA2)
[15:24:54] [GATE7][FAIL] No / invalid POWER_REPORT from RUP
[15:24:54] [UI] Full ATP COMPLETE
[15:24:54] [HW] Shutdown: Full ATP complete
[15:24:54] [HW] END_ATP sent
[15:24:54] [HW] relay_off()
[15:24:54] [FILE] Excel written: ATP_logs/ATP_tyjs_srjh_tsj_hts_2026-01-19_15-23-47.xlsx
[15:24:54] === ATP END ===
